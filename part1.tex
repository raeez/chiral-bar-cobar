\chapter{Operadic Foundations and Bar Constructions}
 
\section{Symmetric Sequences and Operads}

\begin{definition}[Symmetric Monoidal Category]
We work in the symmetric monoidal $\infty$-category $\mathcal{V} = \text{Ch}_\mathbb{C}$ of 
cochain complexes over $\mathbb{C}$ with cohomological grading. The monoidal structure is given by:
\begin{itemize}
\item Unit object: $\mathbb{C}$ concentrated in degree 0
\item Tensor product: $(V \otimes W)^n = \bigoplus_{i+j=n} V^i \otimes W^j$
\item Differential: $d(v \otimes w) = dv \otimes w + (-1)^{|v|}v \otimes dw$
\item Symmetry: $\tau(v \otimes w) = (-1)^{|v||w|}w \otimes v$
\end{itemize}
\textbf{Convention:} We use cohomological grading throughout: $\deg(d) = +1$.

All constructions respect this grading and differential structure. For a morphism $f: V \to W$ of degree $|f|$, the Koszul sign rule gives $f(v \otimes w) = (-1)^{|f||v|}f(v) \otimes w$ when extended to tensor products.

% Added for clarity
\textbf{Explicit Grading Convention:} Throughout this paper, we use cohomological grading with $\deg(d) = +1$, and all degree shifts should be interpreted in this context. For a complex $(C^\bullet, d)$, we have $d: C^n \to C^{n+1}$.

\textbf{Sign Convention for Composition:} When composing morphisms of degree $p$ and $q$, we use the Koszul sign rule: passing an element of degree $p$ past an element of degree $q$ introduces the sign $(-1)^{pq}$.

\textbf{Differential Graded Context:} All categories considered are enriched over the category of cochain complexes, with morphism spaces carrying natural differential structures compatible with composition.

\end{definition}

Let $\cV$ be a symmetric monoidal $\infty$-category. In practice, we primarily work with the category of chain complexes over $\C$ (the field of complex numbers), but the constructions apply more generally to any stable presentable symmetric monoidal category. The choice of characteristic 0 is essential for our residue calculus and will be assumed throughout unless otherwise stated.
 
\begin{definition}[Symmetric Sequence]
A \emph{symmetric sequence} is a collection $P = \{P(n)\}_{n \geq 0}$ where each $P(n)$ is an object of $\cV$ equipped with a right action of the symmetric group $S_n$. Morphisms of symmetric sequences are collections of $S_n$-equivariant maps. When $\cV$ carries a differential structure, we require that the $S_n$-action commutes with differentials.
\end{definition}
 
The fundamental operation on symmetric sequences is the composition product, which encodes the substitution of operations:
 
\begin{definition}[Composition Product]
For symmetric sequences $A$ and $B$, their composition product is defined by:
\[
(A \circ B)(n) = \bigoplus_{k \geq 0} A(k) \otimes_{S_k} \left( \bigoplus_{i_1 + \cdots + i_k = n} \Ind_{S_{i_1} \times \cdots \times S_{i_k}}^{S_n}(B(i_1) \otimes \cdots \otimes B(i_k)) \right)
\]
where $\Ind$ denotes the induced representation functor, using the block diagonal embedding 
\[
S_{i_1} \times \cdots \times S_{i_k} \hookrightarrow S_n
\]
that acts on $\{1, \ldots, i_1\} \sqcup \{i_1 + 1, \ldots, i_1 + i_2\} \sqcup \cdots \sqcup \{i_1 + \cdots + i_{k-1} + 1, \ldots, n\}$.
\end{definition}
 
The composition product is associative up to canonical isomorphism, with unit given by the symmetric sequence $\mathbb{I}$ with $\mathbb{I}(1) = \C$ and $\mathbb{I}(n) = 0$ for $n \neq 1$.
 
\begin{definition}[Operad]
An \emph{operad} $P$ is a monoid for the composition product, equipped with:
\begin{itemize}
\item Composition maps $\gamma : P(k) \otimes P(i_1) \otimes \cdots \otimes P(i_k) \to P(i_1 + \cdots + i_k)$
\item Unit $\eta : \mathbb{I} \to P(1)$ 
\item Associativity axioms ensuring that multi-level compositions are independent of bracketing
\item Equivariance axioms ensuring compatibility with symmetric group actions
\end{itemize}
When $\cV$ has a differential structure, all structure maps must be chain maps.
\end{definition}
 
\begin{definition}[Cooperad]
A \emph{cooperad} is a comonoid for the composition product, with structure maps dual to those of an operad. Explicitly, we have decomposition maps $\Delta : C(n) \to (C \circ C)(n)$ and a counit $\epsilon : C \to \mathbb{I}$ satisfying coassociativity and coequivariance axioms.
\end{definition}
 
\begin{example}[Endomorphism Operad]
For any object $V \in \cV$, the endomorphism operad $\End_V$ has 
\[
\End_V(n) = \Hom_\cV(V^{\otimes n}, V)
\]
with composition given by substitution of multilinear operations. This is the fundamental example motivating the general theory.
\end{example}
 
\section{The Cotriple Bar Construction}
 
Given an adjunction $F \dashv U : \mathcal{A} \rightleftarrows \mathcal{B}$ (with $F$ left adjoint to $U$), we obtain a comonad (also called a cotriple) $G = FU$ on $\mathcal{B}$ with counit $\epsilon : FU \to \text{id}$ and comultiplication $\delta : FU \to FUFU$ induced by the unit and counit of the adjunction.
 
\begin{definition}[Cotriple Bar Resolution]
The cotriple bar resolution of $B \in \mathcal{B}$ is the simplicial object:
\[
B^G_\bullet(B) : \cdots \rightrightarrows (FU)^3B \rightrightarrows (FU)^2B \rightrightarrows FUB \to B
\]
with face maps $d_i : B^G_n \to B^G_{n-1}$ given by:
\begin{itemize}
\item $d_0 = \epsilon \cdot (FU)^{n-1}$ (apply counit at the first position)
\item $d_i = (FU)^{i-1} \cdot \delta \cdot (FU)^{n-i-1}$ for $0 < i < n$ (apply comultiplication at position $i$)  
\item $d_n = (FU)^{n-1} \cdot \epsilon$ (apply counit at the last position)
\end{itemize}
and degeneracy maps $s_i : B^G_n \to B^G_{n+1}$ given by inserting the unit of the adjunction at position $i$.
\end{definition}
 
\begin{example}[Operadic Bar Construction]
For an operad $P$, the free-forgetful adjunction $F_P \dashv U : P\text{-Alg} \rightleftarrows \cV$ yields the classical bar construction $\barB^P_\bullet(A)$ for any $P$-algebra $A$. Explicitly:
\[
\barB^P_n(A) = P \circ \cdots \circ P \circ A \quad \text{($n$ copies of $P$)}
\]
This agrees with the construction via iterated insertions of operations from $P$. The differential is the alternating sum of face maps.
\end{example}
 
\section{The Operadic Bar-Cobar Duality}
 
For an augmented operad $P$ with augmentation $\epsilon : P \to \mathbb{I}$, we construct the bar and cobar functors that establish a fundamental duality:
 
\begin{definition}[Operadic Bar Construction]
The bar construction $\barB(P)$ is the cofree cooperad on the suspension $s\bar{P}$ (where $\bar{P} = \ker(\epsilon)$ is the augmentation ideal) with differential induced by the operadic multiplication. Explicitly:
\[
\barB(P) = T^c(s\bar{P}) = \bigoplus_{n \geq 0} (s\bar{P})^{\circ n}
\]
where $T^c$ denotes the cofree cooperad functor, $(-)^{\circ n}$ denotes the $n$-fold cooperadic composition,
and the differential $d: \barB(P) \to \barB(P)$ is given by:
\[
d = d_{\text{internal}} + d_{\text{decomposition}}
\]
where:
\begin{itemize}
\item $d_{\text{internal}}$ uses the internal differential of $P$
\item $d_{\text{decomposition}}$ encodes edge contractions on trees decorated with operations from $P$
\end{itemize}
\end{definition}

\section{From Cotriple to Geometry: The Conceptual Bridge}

\begin{remark}[Why Configuration Spaces? - The Deep Answer]
The appearance of configuration spaces in the bar complex is not coincidental but forced by the 
fundamental theorem of factorization homology (Ayala-Francis \cite{AF}):

\begin{quote}
\emph{``For a factorization algebra $\mathcal{F}$ on a manifold $M$, its factorization homology 
$\int_M \mathcal{F}$ is computed by a Čech-type complex over the Ran space of $M$.''}
\end{quote}

For chiral algebras (2d factorization algebras with conformal structure), this becomes:
$$\int_X \mathcal{A} \simeq \text{colim}_{n} \left[ \mathcal{A}^{\otimes n} \otimes \Omega^*(\text{Conf}_n(X)) \right]$$

The bar complex is precisely the dual construction, explaining its geometric nature.
\end{remark}

\begin{theorem}[Operadic Bar Complex - Abstract]\label{thm:operadic-bar}
For an operad $\mathcal{P}$ and $\mathcal{P}$-algebra $A$, the bar complex is:
$$B_{\mathcal{P}}(A) = \bigoplus_{n \geq 0} (\mathcal{P}(n) \otimes_{\Sigma_n} A^{\otimes n})[n-1]$$
with differential combining operadic composition and algebra structure.
\end{theorem}

\begin{theorem}[Geometric Realization - The Bridge]\label{thm:geometric-bridge}
For the chiral operad $\mathcal{P}_{\text{ch}}$ on a curve $X$:
\begin{enumerate}
\item $\mathcal{P}_{\text{ch}}(n) \cong \Omega^{n-1}(\overline{C}_n(X))$ (Kontsevich-Soibelman)
\item The operadic composition corresponds to boundary stratification
\item The bar differential becomes residues at collision divisors
\end{enumerate}

This provides a canonical isomorphism:
$$B_{\mathcal{P}_{\text{ch}}}(\mathcal{A}) \cong \bar{B}^{\text{ch}}_{\text{geom}}(\mathcal{A})$$
\end{theorem}

\begin{proof}[Conceptual Proof]
The key insight is recognizing three equivalent descriptions:

\textbf{1. Algebraic (Cotriple):} The bar construction is the comonad resolution
$$\cdots \rightrightarrows \mathcal{P} \circ \mathcal{P} \circ A \rightrightarrows \mathcal{P} \circ A \to A$$

\textbf{2. Categorical (Lurie):} This computes $\text{RHom}_{\mathcal{P}\text{-alg}}(\text{Free}_{\mathcal{P}}(\ast), A)$

\textbf{3. Geometric (Kontsevich):} For the chiral operad, free algebras are sections over configuration spaces

The isomorphism follows from:
$$\mathcal{P}_{\text{ch}}(n) = \pi_*\mathcal{O}_{\text{Conf}_n(X)} \cong \Omega^{n-1}(\overline{C}_n(X))$$
where the last isomorphism uses Poincaré duality and the fact that configuration spaces are $K(\pi,1)$ spaces.
\end{proof}

\section{Com-Lie Koszul Duality from First Principles}
 
\section{Quadratic Operads and Koszul Duality}
 
We now specialize to quadratic operads, which admit a particularly refined duality theory:
 
\begin{definition}[Quadratic Operad]
A quadratic operad has the form $P = \Free(E)/(R)$ where:
\begin{itemize}
\item $E$ is a collection of generating operations concentrated in arity 2
\item $R \subset \Free(E)(3)$ consists of quadratic relations (involving exactly two compositions)
\item $\Free$ denotes the free operad functor
\item $(R)$ denotes the operadic ideal generated by $R$
\end{itemize}
\end{definition}
 
\begin{definition}[Koszul Dual Cooperad]
The Koszul dual cooperad $P^!$ is the maximal sub-cooperad of the cofree cooperad $T^c(s^{-1}E^\vee)$ cogenerated by the orthogonal relations $R^\perp \subset (s^{-1}E^\vee)^{\otimes 2}$, where the orthogonality is with respect to the natural pairing induced by evaluation.
\end{definition}
 
\begin{definition}[Koszul Operad]
An operad $P$ is \emph{Koszul} if the canonical map $\Omega(P^!) \to P$ is a quasi-isomorphism. Equivalently, the Koszul complex $K_\bullet(P) = P^! \circ P$ with differential induced by the cooperad and operad structures is acyclic in positive degrees.
\end{definition}
 
\section{Derivation of Com-Lie Duality}
 
We now prove the fundamental duality between the commutative and Lie operads:
 
\begin{theorem}[Com-Lie Koszul Duality]\label{thm:com-lie}
We have canonical isomorphisms of cooperads:
\[
\Com^! \cong \text{co}\Lie \quad \text{and} \quad \Lie^! \cong \text{co}\Com
\]
Moreover, both $\Com$ and $\Lie$ are Koszul operads with quasi-isomorphisms:
\[
\Omega(\text{co}\Lie) \xrightarrow{\sim} \Com, \quad \Omega(\text{co}\Com) \xrightarrow{\sim} \Lie
\]
\end{theorem}
 
\begin{proof}[Proof via Partition Lattices]
By Theorem \ref{thm:partition}, $\barB(\Com)(n) \simeq s^{n-2}\tilde{C}_{n-2}(\barPi_n) \otimes \sgn_n$.
 
Classical results of Björner-Wachs \cite{BW93} and Stanley \cite{Sta97} establish that the reduced homology of $\barPi_n$ is:
\begin{itemize}
\item The complex $\tilde{C}_*(\barPi_n)$ has homology concentrated in degree $n-2$
\item The $S_n$-representation on $\tilde{H}_{n-2}(\barPi_n)$ decomposes as $\Lie(n) \otimes \sgn_n$ where $\Lie(n)$ is the Lie representation
\item $\tilde{H}_k(\barPi_n) = 0$ for $k \neq n-2$
\end{itemize}
 
The key observation is that $\barPi_n$ has the homology of a wedge of $(n-1)!$ spheres of dimension $n-2$, with the $S_n$-action on the top homology given by the Lie representation tensored with the sign.

To see why this yields Com-Lie duality, observe that the bar construction gives:
$$\barB(\Com)(n) \simeq s^{n-2}\tilde{C}_{n-2}(\barPi_n) \otimes \sgn_n$$
Taking homology and using that $\barPi_n$ is $(n-3)$-connected:
$$H_*(\barB(\Com)(n)) \simeq s^{n-2}\Lie(n) \otimes \sgn_n \otimes \sgn_n = s^{n-2}\Lie(n)$$
Since this is concentrated in a single degree, the bar complex is formal and we obtain:
$$\barB(\Com) \simeq \text{co}\Lie[1]$$
as required.
 
Since the bar complex has homology concentrated in a single degree, it follows that:
\[
H_*(\barB(\Com)) \cong \text{co}\Lie[1]
\]
where the shift accounts for the suspension. Applying $\Omega$ yields $\Omega(\text{co}\Lie) \simeq \Com$.
 
The dual statement $\Lie^! \cong \text{co}\Com$ follows by Schur-Weyl duality, using the characterization of $\Lie$ as the primitive part of the tensor coalgebra.
\end{proof}
 
\begin{proof}[Alternative Proof via Generating Series]
The Poincaré series of the operads satisfy:
\begin{align}
P_{\Com}(x) &= e^x - 1 \\
P_{\Lie}(x) &= -\log(1 - x)
\end{align}
These are compositional inverses: $P_{\Lie}(-P_{\Com}(-x)) = x$. This functional equation characterizes Koszul dual pairs, providing an independent verification of the duality.
\end{proof}
 
\section{The Quadratic Dual and Orthogonality}
 
For explicit computations, we need the quadratic presentations:
 
\begin{proposition}[Quadratic Presentations]
The operads $\Com$ and $\Lie$ have quadratic presentations:
\begin{align}
\Com &= \Free(\mu)/(R_{\Com}) \text{ where } R_{\Com} = \langle \mu_{12,3} - \mu_{1,23}, \mu_{12} - \mu_{21} \rangle \\
\Lie &= \Free(\ell)/(R_{\Lie}) \text{ where } R_{\Lie} = \langle \ell_{12,3} + \ell_{23,1} + \ell_{31,2}, \ell_{12} + \ell_{21} \rangle
\end{align}
where subscripts denote inputs, and composition is denoted by adjacency. Here $\mu_{12,3}$ means $\mu \circ_1 \mu$ and $\mu_{1,23}$ means $\mu \circ_2 \mu$.
\end{proposition}
 
\begin{proposition}[Orthogonality]\label{prop:orthogonal}
Under the natural pairing between $\Free(\mu)(3)$ and $\Free(\ell^*)(3)$ induced by $\langle \mu, \ell^* \rangle = 1$, we have:
\[
R_{\Com} \perp R_{\Lie}
\]
This orthogonality is the concrete manifestation of Koszul duality.
\end{proposition}
 
\begin{proof}
We compute the pairing explicitly. The spaces have bases:
\begin{align}
\Free(\mu)(3) &= \text{span}\{\mu_{12,3}, \mu_{1,23}, \mu_{13,2}, \mu_{2,13}, \mu_{23,1}, \mu_{3,12}\} \\
\Free(\ell^*)(3) &= \text{span}\{\ell^*_{12,3}, \ell^*_{1,23}, \text{etc.}\}
\end{align}
 
The pairing $\langle \mu_{ij,k}, \ell^*_{pq,r} \rangle = 1$ if the tree structures match and $0$ otherwise. Computing:
\begin{align}
\langle \mu_{12,3} - \mu_{1,23}, \ell^*_{12,3} + \ell^*_{23,1} + \ell^*_{31,2} \rangle &= 1 + 0 + 0 - 0 - 0 - 1 = 0 \\
\langle \mu_{12,3} - \mu_{1,23}, \ell^*_{13,2} + \ell^*_{32,1} + \ell^*_{21,3} \rangle &= 0 - 1 + 0 + 0 + 1 + 0 = 0
\end{align}
Similar computations for all pairs verify the orthogonality.
\end{proof}
